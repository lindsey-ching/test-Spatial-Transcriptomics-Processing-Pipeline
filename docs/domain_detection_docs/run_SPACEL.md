# Run SPACEL
---
This module performs pairwise spatial alignment of multiple tissue sections using SPACEL.

## Overview
The run SPACEL step includes:
- Pairwise Alignment - Perform SPACEL alignment using spatial domain clusters as reference
- Coordinate Generation - Generate aligned spatial coordinates for all sections
- Results Saving - Save aligned data with new spatial coordinates

## Input Files
- `../data/*/*/*clustered*.h5ad` - Clustered AnnData file from previous clustering step containing spatial domain annotations

## Output Files
- `../results/whole_dataset/{specimen}_{labtracks_id}_spacel.h5ad` - Aligned AnnData file with SPACEL spatial coordinates
- `../results/whole_dataset/aligned_coordinates.csv` - CSV file containing aligned coordinates across sections
- `../results/whole_dataset/warp_info.npy` - NPY file with transformations applied to each slice

### Added Metadata Columns:

Spatial Alignment Results:
- `obsm['spatial_aligned']`: New aligned spatial coordinates generated by SPACEL algorithm
- `obsm['spatial_pair']`: Coordinates aligned between section pairs

## Configuration Parameters
The parameters are specified as command-line arguments:
- `--specimen`: Specimen identifier for output naming
- `--labtracks_id`: Lab tracking identifier for output naming
- `--n_neighbors`: Number of neighbors used in clustering (for cluster key naming)
- `--res`: Resolution parameter used in clustering (for cluster key naming)
